{#
    Displays the add to cart form

    To see available variables:
        - without enabling Twig debug mode: {{ var_dump() }}
        - using native Twig debugger (Debug mode must be enabled): {{ dump() }}

    @package GPL Cart core
    @author Iurii Makukh <gplcart.software@gmail.com>
    @copyright Copyright (c) 2015, Iurii Makukh
    @license https://www.gnu.org/licenses/gpl.html GNU/GPLv3
    @link http://gplcart.com Support, modules, demo
#}
<form method="post" class="add-to-cart">
  <input type="hidden" name="token" value="{{ token() }}">
  <input type="hidden" name="product[product_id]" value="{{ product.product_id }}">
  {% if product.field.option is defined and product.field.option is not empty %}
      {% for field_id,field_values in product.field.option %}
          {% if field_data.option[field_id] is defined %}    
              <div class="form-group field-widget-{{ field_data.option[field_id]['widget'] }} field-id-{{ field_id }}">
                <label class="field-title">{{ field_data.option[field_id].title }}</label>
                {% if field_data.option[field_id].widget == 'image' %}
                    {% for field_value_id in field_values %}
                        {% if field_data['option'][field_id]['values'][field_value_id] is defined %}
                            <label class="option-combination field-widget-image" data-field-value-id="{{ field_value_id }}" title="{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}">
                              <input class="option" data-field-id="{{ field_id }}" data-field-value-id="{{ field_value_id }}" type="radio" name="product[options][{{ field_id }}]" value="{{ field_value_id }}"{{ field_value_id in product['default_field_values'] ? ' checked' }}>
                              {% if field_data['option'][field_id]['values'][field_value_id]['thumb'] is not empty %}
                                  <span class="btn btn-default has-image" title="{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}" style="background-image: url({{ field_data['option'][field_id]['values'][field_value_id]['thumb'] }})"></span>
                              {% else %}
                                  <span class="btn btn-default">
                                    {{ field_data['option'][field_id]['values'][field_value_id]['title'] }}
                                  </span>
                              {% endif %}
                            </label>
                        {% endif %}
                    {% endfor %}
                {% elseif field_data.option[field_id].widget == 'color' %}
                    {% for field_value_id in field_values %}
                        {% if field_data['option'][field_id]['values'][field_value_id] is defined %}
                            <label class="option-combination field-widget-color" data-field-value-id="{{ field_value_id }}" title="{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}">
                              <input class="option" data-field-id="{{ field_id }}" data-field-value-id="{{ field_value_id }}" type="radio" name="product[options][{{ field_id }}]" value="{{ field_value_id }}">
                              {% if field_data['option'][field_id]['values'][field_value_id]['color'] %}
                                  <span class="btn btn-default" title="{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}" style="background-color:{{ field_data['option'][field_id]['values'][field_value_id]['color'] }}"></span>
                              {% else %}
                                  <span class="btn btn-default no-color">{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}</span> 
                              {% endif %}
                            </label>
                        {% endif %}
                    {% endfor %}
                {% elseif field_data.option[field_id].widget == 'radio' %}
                    {% for field_value_id in field_values %}
                        {% if field_data['option'][field_id]['values'][field_value_id] is defined %}
                            <div class="radio">
                              <label class="option-combination field-widget-radio" data-field-value-id="{{ field_value_id }}" title="{{ field_data['option'][field_id]['values'][field_value_id]['title'] }}">
                                <input class="option" data-field-id="{{ field_id }}" data-field-value-id="{{ field_value_id }}" id="option-{{ field_value_id }}" type="radio" name="product[options][{{ field_id }}]" value="{{ field_value_id }}">
                                {{ field_data['option'][field_id]['values'][field_value_id]['title'] }}
                              </label>
                            </div>
                        {% endif %}
                    {% endfor %}
                {% elseif field_data.option[field_id].widget == 'select' %}
                    <select class="form-control option-combination" name="product[options][{{ field_id }}]">
                      {% for field_value_id in field_values %}
                          {% if field_data['option'][field_id]['values'][field_value_id] is defined %}
                              <option data-field-id="{{ field_id }}" data-field-value-id="{{ field_value_id }}" value="{{ field_value_id }}">
                                {{ field_data['option'][field_id]['values'][field_value_id]['title'] }}
                              </option>
                          {% endif %}
                      {% endfor %}
                    </select>
                {% endif %}
              </div>
          {% endif %}
      {% endfor %}
  {% endif %}
  <button name="add_to_cart" value="1" data-ajax="true" class="btn btn-success btn-block add-to-cart"{{ cart_access ? ' disabled'}}>
    {{ text('Add to cart') }}
  </button>
  <div id="combination-message" style="display:none;"></div>
</form>
