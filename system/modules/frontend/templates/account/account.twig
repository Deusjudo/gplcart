{#
    User account index page

    To see available variables:
        - without enabling Twig debug mode: {{ var_dump() }}
        - using native Twig debugger (Debug mode must be enabled): {{ dump() }}

    @package GPL Cart core
    @author Iurii Makukh <gplcart.software@gmail.com>
    @copyright Copyright (c) 2015, Iurii Makukh
    @license https://www.gnu.org/licenses/gpl.html GNU/GPLv3
    @link http://gplcart.com Support, modules, demo
#}
<div class="row">
  <div class="col-md-3">
    <div class="list-group">
      <a class="list-group-item active disabled">
        <h4 class="list-group-item-heading h5"><b>{{ truncate(user.name, 20) }}</b></h4>
        <p class="list-group-item-text">{{ user.email }}</p>
      </a>
      <a href="{{ url('account/' ~ user.user_id ~ '/address') }}" class="list-group-item">
        <h4 class="list-group-item-heading h5">{{ text('Addresses') }}</h4>
        <p class="list-group-item-text">{{ text('View and manage addressbook') }}</p>
      </a>
      {% if user('user_id') == user['user_id'] or access('user_edit') %}
          <a class="list-group-item" href="{{ url('account/' ~ user.user_id ~ '/edit') }}">
            <h4 class="list-group-item-heading h5">{{ text('Settings') }}</h4>
            <p class="list-group-item-text">{{ text('Edit account details') }}</p>
          </a>
      {% endif %}
    </div>
    {% if user('user_id') == user['user_id'] %}
        <a class="btn btn-default" href="{{ url('logout') }}">
          <span class="fa fa-sign-out"></span> {{ text('Log out') }}
        </a>
    {% endif %}
  </div>
  <div class="col-md-9">
    {% if user['status'] == 0 and access('user') %}
        <div class="alert alert-warning" role="alert">
          {{ text('This account is inactive') }}
        </div>
    {% endif %}
    {% if orders is not empty %}
        <div class="panel-group" id="orders">
          {% for order_id,order in orders %}
              <div class="panel panel-default">
                <div class="panel-heading">
                  <span class="panel-title">
                    <a role="button" data-toggle="collapse" data-parent="#orders" href="#order-{{ order_id }}">
                      <b>#{{ order.order_id }}</b>
                      {{ text('Created') }}:
                      {{ date(order.created) }},
                      {{ text('Status') }}:
                      {% if order.status_formatted is not defined or order.status_formatted is empty %}
                          <span class="text-danger">{{ text('Unknown') }},</span>
                      {% else %}
                          {{ order.status_formatted }},
                      {% endif %}
                      {{ text('Total') }}: {{ order.total_formatted }}
                    </a>
                  </span>
                </div>
                <div id="order-{{ order_id }}" class="panel-collapse collapse">
                  <div class="panel-body">
                    {{ order.rendered|raw }}
                  </div>
                </div>
              </div>
          {% endfor %}
        </div>
        {{ pager|default('') }}
    {% else %}
        {% if user('user_id') == user['user_id'] %}
            {{ text('You have no orders yet. <a href="!href">Shop now</a>', {'!href': url('/')})|raw }}
        {% endif %}
    {% endif %}
  </div>
</div>
